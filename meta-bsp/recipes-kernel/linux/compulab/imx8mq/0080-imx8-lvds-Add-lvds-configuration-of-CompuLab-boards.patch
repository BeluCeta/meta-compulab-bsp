From d186edbcebf16b3dd9f0f01b9c5f865d3d54fcb5 Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Thu, 11 Oct 2018 13:59:02 +0300
Subject: [PATCH 80/86] imx8: lvds: Add lvds configuration of CompuLab boards

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 .../arm64/boot/dts/compulab/sbc-imx8-lvds-dcss.dts | 21 ++++++++++++++++-
 .../boot/dts/compulab/sbc-imx8-lvds-lcdif.dts      | 24 +++++++++++++------
 arch/arm64/boot/dts/compulab/sbc-ucm-imx8-lvds.dts | 27 ++++++++++++++++++----
 3 files changed, 60 insertions(+), 12 deletions(-)

diff --git a/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-dcss.dts b/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-dcss.dts
index 6d84d44..db04d7c 100644
--- a/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-dcss.dts
+++ b/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-dcss.dts
@@ -13,5 +13,24 @@
  */
 
 #include "sbc-imx8.dts"
-#include "compulab-imx8mq-lvds-dcss.dtsi"
+#include "compulab-imx8mq-lvds-mipi.dtsi"
+#include "compulab-imx8mq-mipi-dcss.dtsi"
+
+&i2c3 {
+    status = "okay";
+    goodix_ts@5d {
+    compatible = "goodix,gt911";
+        reg = <0x5d>;
+
+        interrupt-parent = <&gpio3>;
+        interrupts = <3 IRQ_TYPE_EDGE_FALLING>;
+
+        pinctrl-names = "default";
+        pinctrl-0 = <&touchscreen_pins>;
+
+        irq-gpios = <&gpio3 3 GPIO_ACTIVE_HIGH>;
+        reset-gpios = <&gpio3 4 GPIO_ACTIVE_HIGH>;
+        status = "okay";
+    };
+};
 
diff --git a/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-lcdif.dts b/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-lcdif.dts
index 0e11718..f779ba2 100644
--- a/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-lcdif.dts
+++ b/arch/arm64/boot/dts/compulab/sbc-imx8-lvds-lcdif.dts
@@ -13,13 +13,23 @@
  */
 
 #include "sbc-imx8.dts"
-#include "compulab-imx8mq-lvds-lcdif.dtsi"
+#include "compulab-imx8mq-lvds-mipi.dtsi"
+#include "compulab-imx8mq-mipi-lcdif.dtsi"
 
-&dcss {
-	status = "disabled";
-};
+&i2c3 {
+    status = "okay";
+    goodix_ts@5d {
+    compatible = "goodix,gt911";
+        reg = <0x5d>;
 
-&hdmi {
-	status = "disabled";
-};
+        interrupt-parent = <&gpio3>;
+        interrupts = <3 IRQ_TYPE_EDGE_FALLING>;
 
+        pinctrl-names = "default";
+        pinctrl-0 = <&touchscreen_pins>;
+
+        irq-gpios = <&gpio3 3 GPIO_ACTIVE_HIGH>;
+        reset-gpios = <&gpio3 4 GPIO_ACTIVE_HIGH>;
+        status = "okay";
+    };
+};
diff --git a/arch/arm64/boot/dts/compulab/sbc-ucm-imx8-lvds.dts b/arch/arm64/boot/dts/compulab/sbc-ucm-imx8-lvds.dts
index df18a18..00b3748 100644
--- a/arch/arm64/boot/dts/compulab/sbc-ucm-imx8-lvds.dts
+++ b/arch/arm64/boot/dts/compulab/sbc-ucm-imx8-lvds.dts
@@ -12,11 +12,30 @@
  * GNU General Public License for more details.
  */
 
-#include "ucm-imx8.dts"
-#include "sb-ucm-imx8.dtsi"
-#include "compulab-imx8mq-lvds-dcss.dtsi"
+#include "sbc-ucm-imx8.dts"
+#include "compulab-imx8mq-lvds-mipi.dtsi"
+#include "compulab-imx8mq-mipi-lcdif.dtsi"
 
 / {
-    model = "CompuLab UCM-iMX8 on SBC-UCM-iMX8";
+    model = "CompuLab UCM-iMX8 on SBC-UCM-iMX8 + LVDS";
     compatible = "compulab,sbc-ucm-imx8", "compulab,ucm-imx8", "fsl,imx8mq";
 };
+
+&ti_bridge {
+    enable-gpios = <&pca9555 10 GPIO_ACTIVE_HIGH>;
+};
+
+&i2c4 {
+    status = "okay";
+    goodix_ts@5d {
+        compatible = "goodix,gt911";
+        reg = <0x5d>;
+
+        interrupt-parent = <&pca9555>;
+        interrupts = <13 IRQ_TYPE_EDGE_FALLING>;
+
+        irq-gpios = <&pca9555 13 GPIO_ACTIVE_HIGH>;
+        reset-gpios = <&pca9555 14 GPIO_ACTIVE_HIGH>;
+        status = "okay";
+    };
+};
-- 
1.9.1

