From e088a79e42a739f73146883c396e9dab68e61d5a Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Fri, 19 Oct 2018 19:19:49 +0300
Subject: [PATCH 85/86] sb-ucm-imx8: dts: Add ov5640 support

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 arch/arm64/boot/dts/compulab/sb-ucm-imx8.dtsi | 49 +++++++++++++++++++++++++++
 1 file changed, 49 insertions(+)

diff --git a/arch/arm64/boot/dts/compulab/sb-ucm-imx8.dtsi b/arch/arm64/boot/dts/compulab/sb-ucm-imx8.dtsi
index 9f4005f..e70cc2b0 100644
--- a/arch/arm64/boot/dts/compulab/sb-ucm-imx8.dtsi
+++ b/arch/arm64/boot/dts/compulab/sb-ucm-imx8.dtsi
@@ -73,8 +73,57 @@ sbc_i2c_lvds: &i2c4 {
 		status = "okay";
 	};
 
+	ov5640_mipi: ov5640_mipi@3c {
+		compatible = "ovti,ov5640_mipi";
+		reg = <0x3c>;
+		status = "okay";
+		clocks = <&clk IMX8MQ_CLK_CLKO2_DIV>;
+		clock-names = "csi_mclk";
+		assigned-clocks = <&clk IMX8MQ_CLK_CLKO2_SRC>,
+			<&clk IMX8MQ_CLK_CLKO2_DIV>;
+		assigned-clock-parents = <&clk IMX8MQ_SYS2_PLL_200M>;
+		assigned-clock-rates = <0>, <25000000>;
+		csi_id = <0>;
+		pwn-gpios = <&pca9555 8 GPIO_ACTIVE_LOW>;
+		rst-gpios = <&pca9555 7 GPIO_ACTIVE_HIGH>;
+		mclk = <25000000>;
+		mclk_source = <0>;
+		port {
+		    ov5640_mipi1_ep: endpoint {
+			remote-endpoint = <&mipi1_sensor_ep>;
+		    };
+		};
+	};
+};
+
 &sound_codec {
     sound-dai = <&wm8731_ucm>;
 };
 
+&mipi_csi_1 {
+    #address-cells = <1>;
+    #size-cells = <0>;
+    status = "okay";
+    port {
+        mipi1_sensor_ep: endpoint1 {
+            remote-endpoint = <&ov5640_mipi1_ep>;
+            data-lanes = <1 2>;
+        };
+
+        csi1_mipi_ep: endpoint2 {
+            remote-endpoint = <&csi1_ep>;
+        };
+    };
+};
+
+&csi1_bridge {
+    fsl,mipi-mode;
+    fsl,two-8bit-sensor-mode;
+    status = "okay";
+
+    port {
+        csi1_ep: endpoint {
+            remote-endpoint = <&csi1_mipi_ep>;
+        };
+    };
 };
-- 
1.9.1

